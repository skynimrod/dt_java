F._setMod("msg");F._fileMap({"/js/min_mt_f2685b5f.js":["config","start/mt_start","log/mt_all","mt/mt_show","mt/mt_manager","mt/mt_msg_constructor","mt/mt_util","mt/mt_view","mt/mt_tops","mt/mt_module_tip","msg/index_nav_msg","msg/const","msg/data_server","msg/data_adapter"],"/js/mt_ext_374d6257.js":["mt/mt_msg_item","mt/mt_setting","mt/mt_msg_operate","mt/mt_top_operate","msg/index_nav_msg_extend","msg/msg_builder","msg/bind","msg/bind_window"],"/css/mt_min_2d8df993.css":["index_bind_msg.css","mt_mod.css"],"/css/mt_5c59fdce.css":["index_msg.css","mt_module_tip.css"],"/css/msg_extend_b02c37b8.css":["mt_setting.css"],"/js/setting_msg_c5bad54a.js":["msg/const","msg/bind","msg/bind_window"]});F._defService("msg",{start:"start/mt_start",idxNavMsg:"msg/index_nav_msg",dataServer:"msg/data_server",mtShow:"mt/mt_show",snsBind:"msg/bind"});F._firstScreenCSS=F._firstScreenCSS||[];F._firstScreenCSS.push("/css/mt_min_2d8df993.css");F.module("msg:start/mt_start",function(c,b,a){var d=a.base;b.run=function(){a.use("log/mt_all",function(e){e.init()});if(s_session.usertype==20||s_session.usertype==22||s_session.usertype==23){F.call("msg:mt/mt_show","init")}}});F.module("msg:log/mt_all",function(c,b,a){b.init=function(){F.addLog("msg:msg",{guidePopupShow:"0100700000",guidePopupClick:"0100700001",msgNavClick:"0100200001",tipClick:"0100100001"});F.addLog("msg:mt",{msgShow:"1700000000",msgItemClick:"1700100001",msgTopShow:"1700200000",msgItemSourceClick:"1700300001",msgItemDelClick:"1700400001",msgBtnClick:"1700500001",msgHeadClick:"1700600001",operateMTMod:"1700700001",msgSettingClick:"1700800001",msgNewYearClick:"1700900001",msgContentShow:"1701000000"})}});F.module("msg:mt/mt_show",function(b,f,k){var e=k.base;var d=b("superpage:common/user_attr");var a=false,h=false;var j=function(m,l){if(m){if(s_session.usertype==20){d.setAttr("msgModKey",true);i(m)}else{d.setAttr("topModKey",true);i(m)}}else{if(s_session.usertype==20&&s_session.userTips.msgModKey){i()}else{if((s_session.usertype==22||s_session.usertype==23)&&s_session.userTips.topModKey){i()}}}};var i=function(l){e.ajax.get(s_domain.baseuri+"/msg/data/content",function(m){if(m.errNo==0){var n=m.data;if(l){k.use("mt/mt_manager",function(o){o.show(n);F.getService("pack","animate",function(p){p.add("s_mod_msg")})});d.setMultiAttr(["msgFirstSeeKey","msgModKey"],[true,true]);k.fire("operateMTMod",{opType:"add",pos:"addlayer"})}else{if(s_session.usertype==20){F.call("msg:mt/mt_manager","show",n);d.setMultiAttr(["msgFirstSeeKey","msgModKey"],[true,true])}else{if(s_session.usertype==22||s_session.usertype==23){F.call("msg:mt/mt_manager","show",n)}}}}})};var c=function(){F.call("msg:mt/mt_manager","closeMsgMod");var l="addlayer";if(a){l="setlayer"}if(h){l="btnclose"}k.fire("operateMTMod",{opType:"del",pos:l});a=false;h=false};var g=function(l){k.listen("mt/mt_setting","deleteMsgMod",function(m){a=true;l(m)});k.listen("mt/mt_top_operate","deleteMsgMod",function(m){h=true;l(m)})};f.proceDelMsg=g;f.closeMod=c;f.init=j});F.module("msg:mt/mt_manager",function(k,D,x){k("index_msg.css");var h=x.base;var n=k("mt/mt_view");var g=k("mt/mt_util");var e=k("superpage:common/user_attr");var v=k("mt/mt_msg_constructor");var c="s_mod_msg",w="s_msg_count_tip",r="s_msg_title",d="s_msg_top_container",B="s_msg_tops_container",i="s_msg_more_tops",j="s_msg_container",f="s_msg_content",y="s_msg_bottom",s="s_msg_extend_btn",q=false,p=g.logType,z=0,l=0,b=null;var A=function(I){if(!h.g(c)){h.insertHTML("s_modules","afterBegin",n.renderSkeleton())}if(!h.g(f)){if(!I.top.url){var H=h.q("waiting",d)[0];h.g(H).innerHTML="暂无头条新闻"}else{I.top.time=I.top.fmtTime;var G=n.renderTop(I.top,I.tops&&I.tops.length);h.g(d).innerHTML=G;x.fire("msgShow",{modType:"topMod",topType:"top_tops",url:decodeURIComponent(I.top.url),title:I.top.title,count:0,ismis:I.top.mis==1})}F.call("msg:mt/mt_tops","init",I.tops)}if(s_session.usertype==20){if(h.g(f)){F.call("msg:mt/mt_msg_operate","showRefreshContent",I)}else{a(I);var G=n.render(I);h.g(j).innerHTML=G;h.removeClass(j,"unshown");u();var E=I.content.length;if(E>0){if(E>99){h.g(w).innerHTML="99+";h.addClass(w,"count-1")}else{h.g(w).innerHTML=E}h.removeClass(w,"unshown")}e.setAttr("msgModKey",true);F.call("msg:mt/mt_module_tip","init")}}h.on(c,"mouseover",function(){if(!q){F.call("msg:mt/mt_top_operate","init",I);F.call("msg:mt/mt_msg_operate","init",I);q=true}})};var a=function(G){var H=G;p.msgCount=H.content.length;for(var E=0;E<15;E++){if(H.content[E]&&H.content[E].type){if(H.content[E].type=="tv"||H.content[E].type=="show"||H.content[E].type=="comic"){p.video="videoon"}p[H.content[E].type]=H.content[E].type+"on"}}if(H.top&&H.top.title){p.top="topon"}H=null};var u=function(){o();t()};var m=function(M,J,K,E,H){var L=Math.floor(E/50),G=0,N=0;clearInterval(b);b=null;b=setInterval(function(){if(G>=L){I()}else{G++;N=((K-J)*G*G)/(L*L)+J;h.setStyle(M,"height",N+"px")}},50);function I(){if(h.isIE6){h.setStyle(f,"zoom","1")}clearInterval(b);b=null;h.setStyle(M,"height",H&&H.last?H.last+"px":"");H&&H.ondestroy&&H.ondestroy();t()}};var o=function(){g.setState("default");var G=h.q("s-msg-item",h.g(f)),E=G.length;if(E==0){h.hide(f);x.fire("msgShow",{modType:"msgMod",stateType:"msgFoldState"})}else{if(E<=3){if(h.isIE6){h.setStyles(f,{height:E*30+"px",zoom:1})}else{m(f,0,E*30,500,{ondestroy:function(){}})}x.fire("msgShow",{modType:"msgMod",stateType:"msgExtendState"})}else{if(h.isIE6){h.setStyles(f,{height:"90px",zoom:1})}else{m(f,0,90,500,{last:90,ondestroy:function(){}})}x.fire("msgShow",{modType:"msgMod",stateType:"msgExtendState"})}}h.removeClass(j,"unshown")};var t=function(){var G=g.getState(),E=h.q("s-msg-item-outer",h.g(f)).length;switch(G){case"default":if(E>3){h.g(s).className="s-msg-extend-btn";h.g(s).innerHTML="查看更多提醒"}else{h.hide(y)}break;case"extend":h.g(s).className="s-msg-extend-btn to-fold";h.g(s).innerHTML="收起提醒模块";break}};var C=function(){g.setState("default");if(s_session.usertype==20){e.setAttr("msgModKey",false)}F.call("msg:mt/mt_tops","close");F.call("msg:mt/mt_msg_operate","close");F.call("msg:mt/mt_top_operate","close");q=false};D.show=A;D.closeMsgMod=C;D.setModState=t});F.module("msg:mt/mt_msg_constructor",function(b,e,i){var d=i.base;var c=b("superpage:common/user_attr");var f={start:'<div id="s_msg_#{msgId}" class="s-msg-item-outer#{first}#{fourth}"><div class="s-msg-item"><span class="item-name">[<a href="#{nameUrl}" class="item-name-link" target="_blank" hidefocus>#{name}</a>]</span>',end:'<span class="item-source"><span class="source-name">来自<a class="source-link" href="#{sourceUrl}" hidefocus target="_blank">#{sourceName}</a></span><span class="vertical-line">|</span><span class="source-time">#{time}</span></span></div><a href="#" onclick="return false;" hidefocus class="item-del"></a></div>',star:'<a class="item-title" href="#{url}" target="_blank" hidefocus>#{title}</a>',news:'<a class="item-title" href="#{url}" target="_blank" hidefocus>#{title}</a>',navs:'<a class="item-title" href="#{url}" target="_blank" hidefocus>#{title}</a>',comic:'更新至&nbsp;&nbsp;<a class="item-title" href="#{curEpisodeUrl}" target="_blank" hidefocus>#{curEpisode}集</a>#{reviewHtml}',tv:'更新至&nbsp;&nbsp;<a class="item-title" href="#{curEpisodeUrl}" target="_blank" hidefocus>#{curEpisode}集</a>#{reviewHtml}',show:'更新至&nbsp;&nbsp;<a class="item-title" href="#{curEpisodeUrl}" target="_blank" hidefocus>#{curEpisode}期：#{title}</a>',nba:'<a class="item-title" href="#{url}" target="_blank" hidefocus>#{title}</a><span class="vertical-line">|</span><a class="item-title" href="#{nbaMoreUrl}" target="_blank" hidefocus>更多新闻</a><a class="item-title" href="#{nbaTopVideoUrl}" target="_blank" hidefocus>精彩视频</a>',lottery:'<a class="item-title comma" href="#{curEpisodeUrl}" target="_blank" hidefocus>#{curEpisode}开奖结果</a>：<a class="item-title no-underline" href="#{curEpisodeUrl}"  target="_blank" hidefocus><span class="item-orange">#{orangeNumberHtml}</span></a><a class="item-title no-underline" href="#{curEpisodeUrl}"  target="_blank" hidefocus><span class="item-blue">#{blueNumberHtml}</span></a>',csl:'<a class="item-title" href="#{url}" target="_blank" hidefocus>#{title}</a>',guoan:'<a class="item-title" href="#{url}" target="_blank" hidefocus>#{title}</a>',local:'<a class="item-title" href="#{url}" target="_blank" hidefocus>#{title}</a>',dota:'<a class="item-title" href="#{url}" target="_blank" hidefocus>#{title}</a>',tribe:'<a class="item-title" href="#{url}" target="_blank" hidefocus>#{title}</a>#{tribeEnter}',txwb:"#{snsDetailHtml}",bdzoom:"#{snsDetailHtml}",bdmsg:"#{snsDetailHtml}",bdiknow:"#{snsDetailHtml}",bdpics:"#{snsDetailHtml}",mail126:"#{snsDetailHtml}",mail163:"#{snsDetailHtml}",mailyeah:"#{snsDetailHtml}",bdtieba:"#{snsDetailHtml}",sinawb:"#{snsDetailHtml}",blank:'<div class="s-msg-blank">当前没有新提醒</div>'};var a=function(k,j){if(j==0){k.first=" first"}if(j==3){k.fourth=" fourth"}return d.format(f.start+f[k.type]+f.end,g(k))};var g=function(m){var n=m,j=false;if(n.type=="lottery"){n.orangeNumberHtml=n.orangeNumber.split(",").join("&nbsp;&nbsp;&nbsp;");n.blueNumberHtml=n.blueNumber.split(",").join("&nbsp;&nbsp;&nbsp;")}n.url=decodeURIComponent(n.url);n.curEpisodeUrl=decodeURIComponent(n.curEpisodeUrl);if(n.type=="lottery"){n.curEpisodeUrl=n.curEpisodeUrl+"?mtdate="+encodeURIComponent(n.curEpisode)}n.sourceUrl=decodeURIComponent(n.sourceUrl);if(n.type=="tribe"){n.tribeEnter=(c.getAttr("msgGameKey")==3)?'<span class="vertical-line">|</span><a class="item-title" href="http://youxi.baidu.com/login_game_for_general_stat.xhtml?id=429&tp=wyyx" target="_blank" hidefocus>进入游戏</a>':""}else{n.tribeEnter=""}if(n.type=="tv"||n.type=="comic"){var l=[];if(n.review.length>0){for(var k=n.review.length-1;k>=0;k--){l.push('<a class="item-title" href="'+decodeURIComponent(n.review[k].episodeUrl)+'" target="_blank" hidefocus>'+n.review[k].episode+"集</a>")}n.reviewHtml="&nbsp;&nbsp;回顾&nbsp;&nbsp;"+l.join("")}else{n.reviewHtml=""}}j=n.type=="txwb"||n.type=="bdzoom"||n.type=="bdmsg"||n.type=="bdiknow"||n.type=="bdpics"||n.type=="mail126"||n.type=="mail163"||n.type=="mailyeah"||n.type=="bdtieba"||n.type=="sinawb";if(j&&n.snsDetail){var l=[];if(n.snsDetail.length>0){for(var k=n.snsDetail.length-1;k>=0;k--){l.push('<a class="item-title title-sns" href="'+decodeURIComponent(n.snsDetail[k].snsUrl)+'" target="_blank" hidefocus>'+n.snsDetail[k].snsName+'&nbsp;<span class="item-orange">('+n.snsDetail[k].snsNum+")</span></a>")}n.snsDetailHtml=l.join("")}else{n.snsDetailHtml=""}j=false}if(n.type=="nba"){n.name="NBA";n.url=decodeURIComponent(n.url)+"&mtdate="+encodeURIComponent(n.createTime);n.nbaMoreUrl="http://sports.sina.com.cn/nba/?mtdate="+encodeURIComponent(n.createTime);n.nbaTopVideoUrl="http://sports.sina.com.cn/nba/video/?mtdate="+encodeURIComponent(n.createTime)}n.nameUrl="http://www.baidu.com/s?wd="+encodeURIComponent(n.name);return n};var h=function(k){var j=[];if(k.length>0){d.forEach(k,function(m,l){j.push(a(m,l))})}else{j.push(f.blank)}return j.join("")};e.renderAll=h;e.render=a});F.module("msg:mt/mt_util",function(d,c,a){var b="default";c.logType={state:"stateon",top:"topN",star:"starN",tv:"tvN",show:"showN",comic:"comicN",nba:"nbaN",lottery:"lotteryN",video:"videoN",news:"newsN",navs:"navsN",guoan:"guoanN",csl:"cslN",sinawb:"sinawbN",txwb:"txwbN",bdzoom:"bdzoomN",bdmsg:"bdmsgN",bdpics:"bdpicsN",mail126:"mail126N",mail163:"mail163N",mailyeah:"mailyeahN",bdiknow:"bdiknowN",bdtieba:"bdtiebaN",dota:"dotaN",tribe:"tribeN",msgCount:0};c.getState=function(){return b};c.setState=function(e){b=e}});F.module("msg:mt/mt_view",function(e,i,o){var h=o.base;var j=e("mt/mt_msg_constructor");var f=e("superpage:common/user_attr");var d=e("superpage:common/strpx").Strpx;var l=new d("font-size: 12px;font-family: 宋体,arial, sans-serif;");var k={mt:['<div id="s_msg_content" class="s-msg-content" style="height:0px">#{contentHtml}</div>','<div id="s_msg_bottom" class="s-msg-bottom">','<a href="#" onclick="return false;" id="s_msg_extend_btn" hidefocus class="s-msg-extend-btn#{toFold}"></a>',"</div>"].join(""),skeleton:['<div class="s-mod s-mod-msg" id="s_mod_msg">','<a name="msg" class="s-mod-hida" id="msg">&nbsp;</a>','<div class="s-container">','<div class="s-title" id="s_mod_msg_titleBar">','<a title="隐藏" id="s_mod_msg_close" class="s-mod-close-view nav-close-pack" href="javascript:;"></a>',s_session.usertype==20?'<a id="s_mod_msg_rss" href="javascript:;" onclick="return false;" title="订阅管理" class="s-mod-msg-rss" hidefocus=""><em>订阅管理</em><span></span></a>':"","<em>我的提醒</em>",s_session.usertype==20?'<span id="s_msg_count_tip" class="s-msg-count unshown"></span>':"",'<div class="s-title-bg"></div>',"</div>",'<div class="s-content" id="s_mod_msg_content" style="text-align: center;">','<div id="s_msg_top_container" class="top-container"><div class="waiting">新鲜内容，马上呈现...</div></div>','<div id="s_msg_container" class="msg-container"></div>',"</div>","</div>","</div>"].join(""),tops_item:'<div class="tops-item"><span class="item-dot"'+((h.isFirefox||h.browser.opera)?' style="margin-bottom: 20px;" ':"")+'></span><a href="#{url}" target="_blank" hidefocus class="item-title">#{execTitle}</a>#{hotHtml}<span class="item-time">#{time}</span></div>',top:['<div class="s-tops-item">','<a href="#{url}" hidefocus class="top-title" target="_blank">#{title}</a>','<span class="vertical-line #{unshown}">|</span>','<a href="#" id="s_msg_more_tops" onclick="return false;" class="top-title #{unshown}" title="点击查看更多头条" hidefocus>更多头条</a>','<span class="item-source"><span class="source-name">来自<a class="source-link" href="#{sourceUrl}" #{attrTitle} hidefocus target="_blank">#{sourceName}</a></span>','<span class="vertical-line">|</span><span class="source-time">#{time}</span></span>',"</div>"].join(""),top_extend:['<a class="top-name" href="http://news.baidu.com/" hidefocus target="_blank">[头条]</a>','<span class="top-date">#{date}</span>','<span class="vertical-line">|</span>','<a href="#" id="s_msg_more_tops" onclick="return false;" class="top-title" hidefocus>收起</a>'].join("")};var b=function(q){return h.format(k.mt,n(q))};var g=function(r){var q=[];h.forEach(r,function(s){s.url=decodeURIComponent(s.url);s.execTitle=h.encodeHTML(l.substringByPx(h.decodeHTML(s.title),168,"..."));if(s.isHot){s.hotHtml='<span class="item-hot"'+((h.isFirefox||h.browser.opera)?' style="margin-bottom:10px;" ':"")+"></span>"}q.push(h.format(k.tops_item,s))});return q.join("")};var m=function(r,q){if(r){r.url=decodeURIComponent(r.url);r.sourceUrl=decodeURIComponent(r.sourceUrl);if(r.wholeSourceName){r.attrTitle='title="'+r.wholeSourceName+'"'}if((q==0)||(q&&q<=1)){r.unshown="unshown"}return h.format('<a class="top-name" hidefocus target="_blank" href="http://news.baidu.com/">[头条]</a><div class="tops-exchange-container" id="s_tops_exchange_container">'+k.top+"</div>",r)}else{return""}};var p=function(q){return h.format(k.top_extend,q)};var n=function(s){var r=s;var q=r.content.length;r.topUrl=decodeURIComponent(r.top.url);r.topTitle=r.top.title;r.count=(r.content.length>99?"+99":r.content.length);r.contentHtml=j.renderAll(r.content);if(!r.top||!r.top.title){r.notop=" unshown"}else{r.notop=""}r.toFold=q>3?" to-fold":"";if(q==0){r.tipCount=" tip-0"}if(q>0&&q<=9){r.tipCount=" tip-1"}else{if(q>9&&q<=99){r.tipCount=" tip-2"}else{if(q>99){r.tipCount=" tip-3"}}}return r};var c=function(){return k.skeleton};var a=function(q){if(q){q.url=decodeURIComponent(q.url);q.sourceUrl=decodeURIComponent(q.sourceUrl);if(q.wholeSourceName){q.attrTitle='title="'+q.wholeSourceName+'"'}return h.format(k.top,q)}else{return""}};i.render=b;i.renderTops=g;i.renderTop=m;i.renderTopExtend=p;i.renderSkeleton=c;i.renderTopExchange=a});F.module("msg:mt/mt_tops",function(j,s,n){var f=n.base,k=new j("superpage:common/tween").Class,l=j("mt/mt_view");var h="s_msg_top_container",a="s_tops_exchange_container",r=null,i=[],p=1,m=0,o=false,e=null,g=false,b=false;s.init=function(t){if(!b){q(t);d();b=true}};var d=function(){f.on(h,"mouseover",function(t){if(!f.hasClass(h,"extend")){g=true}});f.on(h,"mouseout",function(){if(!f.hasClass(h,"extend")){g=false}});f.on(h,"click",function(v){var u=f.event.getTarget(v),t=r[(p==0?m-1:p-1)];if(!t){return}if(u.tagName&&u.tagName.toUpperCase()=="A"){if(f.hasClass(u,"top-name")){n.fire("msgItemClick",{msgType:"topMod",topType:"top_tops",msgpos:"name",url:t.url,title:t.title,count:p==0?m-1:p-1,ismis:t.mis==1})}else{if(f.hasClass(u,"source-link")){n.fire("msgItemSourceClick",{msgType:"top",url:t.url,title:t.title})}else{if(f.hasClass(u,"top-title")&&u.id!="s_msg_more_tops"){n.fire("msgItemClick",{msgType:"topMod",topType:"top_tops",msgpos:"title",url:t.url,title:t.title,count:p==0?m-1:p-1,ismis:t.mis==1})}}}}});if(!b){if(m>=2){e=setInterval(c,6000)}}};var q=function(t){r=t;m=r.length;f.forEach(r,function(v){var u=f.extendObject({},v);u.time=u.fmtTime;i.push(l.renderTopExchange(u))})};var c=function(){if(g){return}if(!f.g("s_mod_msg")){return}var t=f.q("s-tops-item",a)[0];f.insertHTML(a,"beforeEnd",i[p]);new k({duration:300,trans:"regularEaseIn",from:0,to:-24,func:function(){f.setStyle(t,"marginTop",this.tween+"px")},ondestroy:function(){t=f.q("s-tops-item",a)[0];if(t){f.remove(t)}if(!o&&r){n.fire("msgShow",{modType:"topMod",topType:"top_tops",url:decodeURIComponent(r[p].url),title:r[p].title,count:p,ismis:r[p].mis==1})}if(p<m-1){p++}else{p=0;o=true}}})};s.start=function(){g=false;d();clearInterval(e);e=null;e=setInterval(c,6000)};s.stop=function(){g=true;clearInterval(e);e=null};s.getCur=function(){return p==0?m-1:p-1};s.close=function(){clearInterval(e);e=null;r=null;i=[];p=1;m=0;b=false;g=false;if(s_session.usertype==22||s_session.usertype==23){F.getService("superpage","userAttr",function(t){t.setAttr("topModKey",false)})}}});F.module("msg:mt/mt_module_tip",function(a,e,i){a("mt_module_tip.css");var d=i.base,c=a("superpage:common/user_attr");var b="s_msg_module_tip",j=false,g='<span id="'+b+'" class="s-msg-module-tip '+(d.isFirefox?"use-img":"")+'">点击这里，订阅更多精彩提醒。<div class="tip-triangle-ff"></div><div class="tip-triangle-outer"></div><div class="tip-triangle"></div><a hidefocus href="#" onclick="return false;" class="tip-close"></a></span>';e.init=function(){if(s_session.usertype==20&&c.getAttr("msgModuleTip")&&window.sysTime*1000<1369584000000){d.insertHTML(d.g("s_mod_msg_titleBar"),"beforeEnd",g);h()}};var h=function(){var k=d.g(b),l=d.q("tip-close",k)[0];d.on(l,"click",f);i.listen("mt/mt_msg_operate","msgBtnClick",function(m){if(m.opType=="setting"){f()}})};var f=function(){if(!j){d.g(b)&&d.remove(b);c.setAttr("msgModuleTip",false);j=true}}});F.module("msg:msg/index_nav_msg",function(d,h,o){var b=d("msg/const"),e=d("msg/data_server"),g=o.base;var c={MARK_MSG_NUM:'<span class="#{classname}"><span>#{number}</span></span>',MARK_MSG_NEW:'<span class="#{classname}"><span>1</span></span>',MARK_BIND:'<span class="bm-mark bm-bind"><a class="bm-bind-link" target="_blank" href="#" onclick="return false">&nbsp;</a></span>',MARK_APP_BIND:'<span class="bm-mark bm-bind"><a class="bm-bind-link" target="_blank" href="#{bindUrl}" onclick="return true;">&nbsp;</a></span>',MARK_EMAIL:'<span class="bm-mark bm-email-pwd"></span>'};var a=function(s,u){var r=e.getData(s);var q,t,p;if(!r){u()}else{switch(r.dataType){case b.DATA_TYPE.BIND:q=c.MARK_BIND;t="afterEnd";break;case b.DATA_TYPE.MSG:if(b.util.needShowMsg(r)||b.util.needShowNew(r)){t="beforeEnd";q=g.formatString(c["MARK_MSG_"+r.markType.toUpperCase()],{classname:"bm-mark bm-hasmsg",number:r.number>99?"99+":r.number})}else{t="beforeEnd"}break;case b.DATA_TYPE.EMAIL:q=c.MARK_EMAIL;t="beforeEnd";break}}if(t){p=b.util.getNavData(r)}u(t,q,p)};var f=function(q,r){var p=e.getData(q);if(!p){r()}else{o.use("msg/index_nav_msg_extend",function(t){var s=t.getNavConfig(p);r(s)})}};var j=function(){F.getService("nav","addProxy",function(p){if(!p.isEmptyNavUser){e.loadData()}})};var n=function(){j();o.listen("nav:nav","addNavItem",function(p){setTimeout(function(){i(p.id)},1000)});o.listen("msg/bind","bindEnd",function(p){i(p.navId)})};var i=function(p){F.getService("nav","nav",function(r){var q=r.ndc.getNavById(p);if(!q){return}e.updateData(p,q.url)})};var k=function(p){var q=e.getData(p);F.getService("nav","nav",function(r){navLog=r.ndc.getNavParams(p)||{};if(!q){o.warn("msgSawError","no msg with id"+p);return}else{o.use("msg/index_nav_msg_extend",function(s){s.msgSaw(q)})}o.fire("tipClick",g.extend({tipType:b.MSG.tipType.VIDEO,webid:q.webId,videoUrl:q.msgDetail&&q.msgDetail.curObjUrl,finish:q.msgDetail&&q.msgDetail.finish},navLog))})};var m=function(q){var p=e.getData(q);F.getService("nav","nav",function(r){navLog=r.ndc.getNavParams(q)||{};if(!p){o.warn("msgSawError","no msg with id"+q);return}o.use("msg/bind",function(s){s.emailRebind(p,{navId:q})});o.fire("tipClick",g.extend({tipType:b.MSG.tipType.EMAIL,webid:p.webId,bindStatus:msg.bindStatus,bindType:msg.bindType},navLog))})};var l=function(q,p){var r=e.getData(q);window.urSendClick=window.urSendClick||function(){};window.urSendClick({pid:"super",mod:"msg",type:"msgtip",method:"click",jump:"1",webid:r.webId});F.getService("nav","nav",function(s){navLog=s.ndc.getNavParams(q)||{};if(!r){o.warn("msgSawError","no msg with id"+q);return}o.fire("tipClick",g.extend({tipType:b.MSG.tipType.LIST,webid:r.webId,bindStatus:r.bindStatus,bindType:r.bindType},navLog))})};h.getMarkConfig=a;h.getMsgConfig=f;h.msgSaw=k;h.emailRebind=m;h.msgDetailClick=l;h.init=n;h.loadData=j});F.module("msg:msg/const",function(a,c,j){var b=j.domain;var h="frombaidu=1";var e={hadBind:{YES:"1",NO:"0"},bindType:{IN:"2",OUT:"1",INNER:"3",EMAIL:"4",RELOGIN:"5"},outSubBindType:{OLD:"0",NEW:"1",APP:"-2"},receive:{YES:"0",NO:"1"},canReceive:{YES:"2",NO:"1"},msgsettingConnect:{INNER:"1",CAN:"2",CANNOT:"3"},showPopup:{YES:"2",NO:"4"}};var i={video:{finish:{YES:1,NO:0},saw:{YES:1,NO:0}},markType:{NUM:"num",NEW:"new",EXCA:"exca"},tipType:{LIST:"list",VIDEO:"video",EMAIL:"email",NOVEL:"novel"}};var g={BIND:"bind",MSG:"msg",EMAIL:"email",SETTING:"setting"};var f={dataSetting:b.baseuri+"/msg/data/setting",dataMsg:b.baseuri+"/nplus/data/msg",showEmail:b.baseuri+"/msg/show/email",showSetting_msg:b.baseuri+"/page/show/setting?tab=msg",submitEmailbind:b.baseuri+"/msg/submit/emailbind",submitEmailunbind:b.baseuri+"/msg/submit/emailunbind",submitReceive:b.baseuri+"/msg/submit/receive",submitBind:b.baseuri+"/msg/submit/bind",submitUnbind:b.baseuri+"/msg/submit/unbind",submitMsgsaw:b.baseuri+"/msg/submit/msgsaw",submitPoptip:b.baseuri+"/msg/submit/poptip",openBind:b.baseuri+"/msg/open/bind",openRejump:b.baseuri+"/msg/open/rejump",passStartlogin:"http://passport.baidu.com/phoenix/account/startlogin"};var d={getNavData:function(k){return{navId:k.navId,name:k.fullName,url:k.url,icon:k.icon,reBind:k.reBind}},addFromBaidu:function(k){if(k.indexOf(h)>0){return k}var m=k.split("#"),l=m[0];l=l+(l.indexOf("?")>-1?"&":"?")+h;m[0]=l;return m.join("#")},windowOpen:function(m,l,o,n){var k=null;try{k=window.open(m,l,o,n);if(k==null){arg[0]="";k=window.open.apply("",l,o,n);k.location.href=m}}catch(p){j.fail("windowOpenFailed","window.open失败",{userAgent:navigator.userAgent})}if(!k){j.fail("windowOpenFailed","window.open为空",{userAgent:navigator.userAgent})}return k},needShowMsg:function(k){switch(k.markType){case i.markType.NUM:return k.number&&k.receive==e.receive.YES;break;case i.markType.NEW:return d.needShowNew(k);break;case i.markType.EXCA:return true;break}},needShowNew:function(k){return k.msgDetail.finish==i.video.finish.NO&&k.msgDetail.saw==i.video.saw.NO},isNewWeb:function(k){return k.bindType==e.bindType.OUT&&k.subBindType==e.outSubBindType.NEW},isAppWeb:function(k){return k.bindType==e.bindType.OUT&&k.subBindType==e.outSubBindType.APP}};c.util=d;c.BIND=e;c.URLS=f;c.MSG=i;c.DATA_TYPE=g});F.module("msg:msg/data_server",function(c,f,n){var b=c("msg/const"),j=b.URLS,h=c("msg/data_adapter");var e=n.base;var d={};var i=function(){e.ajax.get(j.dataMsg+"?asyn=1&t="+new Date().getTime(),function(r){var q=[];var r=h.convert(r);for(var s in r){q.push(s)}d=r;n.fire("dataUpdated",{relatedNavs:q});var t={"2":true,"6":true,"311638":true};for(var o in r){var p=r[o];if(p&&p.bindStatus=="binded"&&t[p.webId]){window.urMsgData=window.urMsgData||[];window.urMsgData.push({pid:"super",mod:"msg",type:"msgtip",webid:p.webId})}}if(window.urMsgData&&window.urMsgData.length>0&&window.urSendStaticData){for(var o in urMsgData){urSendStaticData(urMsgData[o],((+o)||0)*300)}}})};var k=function(p,o){e.ajax.get(j.dataMsg+"?asyn=1&shortcutid="+p+"&shortcuturl="+o+"&t="+Math.random(),function(q){if(!q.shortcutInfo){return}q=h.convertUpdatedData(q);m(q)})};var g=function(o){return d[o]};var m=function(o){d[o.navId]=o;n.fire("dataUpdated",{relatedNavs:[o.navId]})};var a=function(u,p){var t=d[u];if(!t){return}var r=p.attr.split("."),q=t;for(var s=0,o=r.length;s<o-1;s++){q=q[r[s]]}q[r[s]]=p.value;if(p.isEffectUI){n.fire("dataUpdated",{relatedNavs:[u]})}};var l=function(){return d};f.loadData=i;f.updateData=k;f.getData=g;f.setData=m;f.getDataCache=l;f.setDataAttr=a});F.module("msg:msg/data_adapter",function(c,e,l){var b=c("msg/const"),a=b.BIND,g=b.MSG;var d=l.base;var j=function(m){return m};var k=function(m){m.msgId=m.msgDetail.msgId||"";m.markType=m.resType=="1"?g.markType.NEW:g.markType.NUM;m.tipType=m.resType=="1"?(m.msgDetail.videoType==4?g.tipType.NOVEL:g.tipType.VIDEO):g.tipType.LIST;m.isResource=m.resType=="1";return m};var f=function(m){m.bindType=a.bindType.EMAIL;m.subBindType=m.webId;m.markType=g.markType.EXCA;m.tipType=g.markType.EMAIL;return m};var i=function(n){var m={};d.forEach(n.shortcutUnbind,function(o){o=j(o);o.bindStatus="unbind";m[o.navId]=o});d.forEach(n.userDetailMsg,function(o){o=k(o);o.bindStatus="binded";m[o.navId]=o});if(n.emailRebind){d.forEach(n.emailRebind,function(o){o=f(o);o.bindStatus="rebind";m[o.navId]=o})}return m};var h=function(o){var n=o.shortcutInfo,m=null;switch(n.dataType){case"msg":m=k(n);break;case"bind":m=j(n);break}return m};e.convert=i;e.convertUpdatedData=h});